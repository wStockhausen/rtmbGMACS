<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="William Stockhausen">

<title>Model Functions and Parameters – rtmbGMACS: the Generalized Model for Assessing Crustacean Stocks, ported to RTMB</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../website/05_ADMB-InputFiles.html" rel="next">
<link href="../website/03_ModelDimensions.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-ed0c7fd37fae853d7e0c7385bd49c55c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-4f2cc58a03e77be873a0973df801f2c0.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../website/04_FunctionsAndParametersSpecification.html">Functions and Parameters Specification</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">rtmbGMACS: the Generalized Model for Assessing Crustacean Stocks, ported to RTMB</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../website/01_Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../website/02_PopDyMod.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Population Dynamics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../website/03_ModelDimensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Dimensions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../website/04_FunctionsAndParametersSpecification.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Functions and Parameters Specification</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../website/05_ADMB-InputFiles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using ADMB Input files</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#model-processes-functions-and-parameters" id="toc-model-processes-functions-and-parameters" class="nav-link active" data-scroll-target="#model-processes-functions-and-parameters">Model processes, functions and parameters</a></li>
  <li><a href="#ctl-file-syntax-under-development" id="toc-ctl-file-syntax-under-development" class="nav-link" data-scroll-target="#ctl-file-syntax-under-development">CTL file syntax (UNDER DEVELOPMENT)</a>
  <ul class="collapse">
  <li><a href="#function-and-parameter-specification" id="toc-function-and-parameter-specification" class="nav-link" data-scroll-target="#function-and-parameter-specification">Function and parameter specification</a></li>
  </ul></li>
  <li><a href="#sec-InitAbd" id="toc-sec-InitAbd" class="nav-link" data-scroll-target="#sec-InitAbd">Initial abundance</a></li>
  <li><a href="#sec-Allom" id="toc-sec-Allom" class="nav-link" data-scroll-target="#sec-Allom">Allometry</a></li>
  <li><a href="#sec-Rec" id="toc-sec-Rec" class="nav-link" data-scroll-target="#sec-Rec">Recruitment</a></li>
  <li><a href="#sec-NatM" id="toc-sec-NatM" class="nav-link" data-scroll-target="#sec-NatM">Natural mortality</a></li>
  <li><a href="#sec-Grw" id="toc-sec-Grw" class="nav-link" data-scroll-target="#sec-Grw">Growth</a></li>
  <li><a href="#sec-Mat" id="toc-sec-Mat" class="nav-link" data-scroll-target="#sec-Mat">Maturity</a></li>
  <li><a href="#sec-Sel" id="toc-sec-Sel" class="nav-link" data-scroll-target="#sec-Sel">Selectivity</a>
  <ul class="collapse">
  <li><a href="#sec-LogisticFunctions" id="toc-sec-LogisticFunctions" class="nav-link" data-scroll-target="#sec-LogisticFunctions">Logistic functions</a></li>
  <li><a href="#sec-AscNormalFunctions" id="toc-sec-AscNormalFunctions" class="nav-link" data-scroll-target="#sec-AscNormalFunctions">Ascending normal functions</a></li>
  <li><a href="#sec-DoubleLogisticFunctions" id="toc-sec-DoubleLogisticFunctions" class="nav-link" data-scroll-target="#sec-DoubleLogisticFunctions">Double logistic functions</a></li>
  <li><a href="#double-logistic-function-alternative-1" id="toc-double-logistic-function-alternative-1" class="nav-link" data-scroll-target="#double-logistic-function-alternative-1">Double logistic function (alternative 1)</a></li>
  <li><a href="#double-logistic-function-alternative-2" id="toc-double-logistic-function-alternative-2" class="nav-link" data-scroll-target="#double-logistic-function-alternative-2">Double logistic function (alternative 2)</a></li>
  <li><a href="#sec-DoubleNormalFunctions" id="toc-sec-DoubleNormalFunctions" class="nav-link" data-scroll-target="#sec-DoubleNormalFunctions">Double normal functions</a></li>
  <li><a href="#sec-Splines" id="toc-sec-Splines" class="nav-link" data-scroll-target="#sec-Splines">Splines</a></li>
  <li><a href="#sec-OtherSelFcns" id="toc-sec-OtherSelFcns" class="nav-link" data-scroll-target="#sec-OtherSelFcns">Other selectivity functions</a></li>
  </ul></li>
  <li><a href="#sec-FM" id="toc-sec-FM" class="nav-link" data-scroll-target="#sec-FM">Fishing mortality</a></li>
  <li><a href="#sec-Srv" id="toc-sec-Srv" class="nav-link" data-scroll-target="#sec-Srv">Survey catchability</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/wStockhausen/rtmbGMACS/edit/main/website/04_FunctionsAndParametersSpecification.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/wStockhausen/rtmbGMACS/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Model Functions and Parameters</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>William Stockhausen </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<!--NOTE: for scalar variables,    use: *var*   (italics)  
          for vectors/matrices,etc use: ***V*** (bold-italics) 
          for functions            use: **fcn** (bold) 
          for verbatim code        use: `code` 
-->
<section id="model-processes-functions-and-parameters" class="level2">
<h2 class="anchored" data-anchor-id="model-processes-functions-and-parameters">Model processes, functions and parameters</h2>
<p>rtmbGMACS can encapsulate the following population- and observation-related processes in a model:</p>
<ul>
<li>initial abundance</li>
<li>allometry (weight-at-size)</li>
<li>recruitment</li>
<li>natural mortality</li>
<li>growth</li>
<li>maturation</li>
<li>size-specific functions (e.g., selectivity and retention)</li>
<li>fishing mortality</li>
<li>survey catchability</li>
<li>movement (TBD?)</li>
</ul>
<p>Each of these processes can be included in the final model using selections among a number of possible functional forms, each with associated parameters defined using a hierarchical structure. In this hierarchical structure, “top-level” parameters can be fixed or estimated as fixed effects and time-variation can be added through annually-varying offsets (as fixed or random effects) which can, in turn, be linear functions of environmental covariates.</p>
</section>
<section id="ctl-file-syntax-under-development" class="level2">
<h2 class="anchored" data-anchor-id="ctl-file-syntax-under-development">CTL file syntax (UNDER DEVELOPMENT)</h2>
<p>Both functions and parameters for all processes are defined in the “CTL” file (the actual filename of which is arbitrary). The CTL file is a text file: comments follow a “#” symbol while function and parameter specifications are made using white space-delimited tables with a header line with column names and a final line specifying “END TABLE”. Sections defining individual processes are delimited by a line starting with the name of the process to be defined (e.g.&nbsp; “RECRUITMENT”) and a line indicating the end of the process definition (e.g., “END RECRUITMENT”).</p>
<section id="function-and-parameter-specification" class="level3">
<h3 class="anchored" data-anchor-id="function-and-parameter-specification">Function and parameter specification</h3>
<p>Functions and parameters within a process definition section are defined using table structures that are read in as tibbles.</p>
<section id="functions" class="level4">
<h4 class="anchored" data-anchor-id="functions">Functions</h4>
<p>Function tables start a header line with a <code>fcn_id</code> column followed by other column names specific to the process being defined, ending with a <code>label</code> column. Rows following the header line specify the functions that combine to define the process for a specified time block and (possibly) combination of population classes. <a href="#tbl-Ex1" class="quarto-xref">Table&nbsp;1</a> provides an example table for the recruitment process.</p>
<div id="tbl-Ex1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-Ex1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Example table of function definitions for the recruitment process.
</figcaption>
<div aria-describedby="tbl-Ex1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 21%">
<col style="width: 10%">
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">fcn_id</th>
<th style="text-align: center;">time_block</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">size_fcn</th>
<th style="text-align: center;">max size</th>
<th style="text-align: center;">rec_type</th>
<th style="text-align: left;">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">2001:2005</td>
<td style="text-align: center;">all</td>
<td style="text-align: center;">gamma</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">noSR1</td>
<td style="text-align: left;">basic_rec</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">2006:2023</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">gamma</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">noSR1-RW</td>
<td style="text-align: left;">male_rec2006+</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">2006:2023</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">gamma</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;">noSR1-RW</td>
<td style="text-align: left;">female_rec2006+</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>In the table, <code>fcn_id</code> provides a unique row reference to refer back to a function definition, <code>time_block</code> specifies the years to which the definition applies, <code>sex</code> specifies the sex to which it applies, etc. The columns <code>fcn_id</code> and <code>label</code> must be present in each function definition table, but otherwise the column names are specific to the process in question. Additionally, the columns may be in any order.</p>
</section>
<section id="parameters" class="level4">
<h4 class="anchored" data-anchor-id="parameters">Parameters</h4>
<p>The parameters associated with each function defined in the function definitions table are defined in a hierarchical set of tables either as</p>
<p><span id="eq-Eq1"><span class="math display">\[p_{t,c} = p_{t_{ref},c} + \delta p_{t,c} + \left[ \sum_{e} \alpha_{e} \cdot v_{e,t} + \beta_e \right]  \tag{1}\]</span></span></p>
<p>or</p>
<p><span id="eq-Eq2"><span class="math display">\[p_{t,c} = p_{t_{ref},c} + s \cdot \sum_{t'=t_{ref}+s}^t\delta p_{t',c} + \left[ \sum_{e} \alpha_{e} \cdot v_{e,t} + \beta_e \right]  \tag{2}\]</span></span></p>
<p>In <a href="#eq-Eq1" class="quarto-xref">Equation&nbsp;1</a>, the <span class="math inline">\(\delta p_{t,c}\)</span> are annual offsets to <span class="math inline">\(p_{t_{ref},c}\)</span> with <span class="math inline">\(\delta p_{t_{ref},c}=0\)</span> while <span class="math inline">\(s\)</span> in <a href="#eq-Eq2" class="quarto-xref">Equation&nbsp;2</a> is <span class="math inline">\(sgn(t-t_{ref})\)</span> and the <span class="math inline">\(\delta p_{t,c}\)</span> are annual random walk innovations. The <span class="math inline">\(\delta p_{t,c}\)</span> can be either fixed or random effects. The effect of any environmental covariates is modeled as a sum over individual linear effects, the <span class="math inline">\(\alpha_{e}\)</span> and <span class="math inline">\(\alpha_{e}\)</span> are the (potentially) estimable fixed effects and <span class="math inline">\(v_{e,t}\)</span> represents the value at time <span class="math inline">\(t\)</span> of the <em>e</em>-th covariate.</p>
<section id="reference-level-parameters" class="level5">
<h5 class="anchored" data-anchor-id="reference-level-parameters">Reference-level parameters</h5>
<p>The reference-level parameters are defined in tables similar to <a href="#tbl-Ex2" class="quarto-xref">Table&nbsp;2</a>, which is an example that defines the <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> parameters for the recruitment-at-size gamma functions from <a href="#tbl-Ex1" class="quarto-xref">Table&nbsp;1</a>.</p>
<div id="tbl-Ex2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-Ex2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Example table of reference-level parameters.
</figcaption>
<div aria-describedby="tbl-Ex2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">fcn_id</th>
<th style="text-align: center;">param</th>
<th style="text-align: center;">par_id</th>
<th style="text-align: center;">ref_time</th>
<th style="text-align: center;">scale</th>
<th style="text-align: center;">units</th>
<th style="text-align: center;">ival</th>
<th style="text-align: center;">lb</th>
<th style="text-align: center;">ub</th>
<th style="text-align: center;">phz</th>
<th style="text-align: center;">pr_type</th>
<th style="text-align: center;">p1</th>
<th style="text-align: center;">p2</th>
<th style="text-align: center;">offsets</th>
<th style="text-align: center;">covars</th>
<th style="text-align: left;">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">alpha</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">ln</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">9.33</td>
<td style="text-align: center;">2.7</td>
<td style="text-align: center;">56</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">e1,e2</td>
<td style="text-align: left;">alpha1</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">beta</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2001</td>
<td style="text-align: center;">ln</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">3.86</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">3.9</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">NA</td>
<td style="text-align: left;">beta1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">alpha</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">2006</td>
<td style="text-align: center;">ln</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">9.33</td>
<td style="text-align: center;">2.7</td>
<td style="text-align: center;">56</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">e1,e2</td>
<td style="text-align: left;">alpha2</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">alpha</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2011</td>
<td style="text-align: center;">ln</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">9.33</td>
<td style="text-align: center;">2.7</td>
<td style="text-align: center;">56</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">NA</td>
<td style="text-align: left;">alpha3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">beta</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">2006</td>
<td style="text-align: center;">ln</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">3.86</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">3.9</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">NA</td>
<td style="text-align: left;">beta2</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">alpha</td>
<td style="text-align: center;">-3</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">beta</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>In <a href="#tbl-Ex2" class="quarto-xref">Table&nbsp;2</a>:</p>
<ul>
<li><code>fcn_id</code> identifies a row in the function definition table</li>
<li><code>param</code> identifies the name of the relevant parameter being specified</li>
<li><code>par_id</code> associates a unique positive integer with the parameter, or a negative value indicating substitution with the parameter associated with the positive value</li>
<li><code>ref_time</code> identifies the reference time for parameters with a hierarchical structure</li>
<li><code>scale</code> indicates the scale used to specify the initial value, bounds, and prior (the values will be subsequently transformed as necessary to the scale used for the parameter in the model)</li>
<li><code>units</code> indicates any units associated with the initial value, bounds, and prior</li>
<li><code>ival</code>, <code>lb</code>, <code>ub</code> specify the initial value and lower and upper bounds</li>
<li><code>phz</code> identifies the estimation phase in which the parameter should be “turned on” (never estimated if &lt; 0)</li>
<li><code>pr_type</code> specifies the prior probability function associated with the estimated parameter</li>
<li><code>p1</code>,<code>p2</code> specify parameter values for the prior</li>
<li><code>offsets</code> indicates whether annually-varying offset parameters (i.e., the <span class="math inline">\(\delta p_{t,c}\)</span>) should be associated with the reference parameter</li>
<li><code>covars</code> specifies the covariates (if any) text string to associate with the reference parameter as a comma-delimited</li>
<li><code>label</code> specifies a specific label to use for the parameter</li>
</ul>
<p>The columns may be in any order, but (unlike a function definition table) all columns should be present.</p>
</section>
<section id="parameter-offsets" class="level5">
<h5 class="anchored" data-anchor-id="parameter-offsets">Parameter offsets</h5>
<p>If parameter offsets are defined for any reference parameter, then a table defining these offsets needs to follow the table defining the reference parameters. The annually-varying parameter offsets (i.e., the <span class="math inline">\(\delta p_{t,c}\)</span>) are defined in tables similar to <a href="#tbl-Ex3" class="quarto-xref">Table&nbsp;3</a>, which follows on from <a href="#tbl-Ex2" class="quarto-xref">Table&nbsp;2</a>:</p>
<div id="tbl-Ex3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-Ex3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Example table of offset-level parameters.
</figcaption>
<div aria-describedby="tbl-Ex3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">par_id</th>
<th style="text-align: center;">off_id</th>
<th style="text-align: center;">time_block</th>
<th style="text-align: center;">param</th>
<th style="text-align: center;">scale</th>
<th style="text-align: center;">units</th>
<th style="text-align: center;">phz</th>
<th style="text-align: center;">off_type</th>
<th style="text-align: center;">RE</th>
<th style="text-align: center;">ival</th>
<th style="text-align: center;">pr_type</th>
<th style="text-align: center;">p1</th>
<th style="text-align: center;">p2</th>
<th style="text-align: center;">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2001:2005</td>
<td style="text-align: center;">beta</td>
<td style="text-align: center;">ar</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">offset</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">normal</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">dvs_beta</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2011:2023</td>
<td style="text-align: center;">alpha</td>
<td style="text-align: center;">ar</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">RW</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">normal</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">rw_alpha</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>In <a href="#tbl-Ex3" class="quarto-xref">Table&nbsp;3</a>:</p>
<ul>
<li><code>par_id</code> identifies a row in the reference parameters definition table</li>
<li><code>off_id</code> associates a unique positive integer with the parameter, or a negative value indicating substitution with the parameter associated with the positive value</li>
<li><code>time_block</code> identifies the time block across which the offset parameters are defined</li>
<li><code>param</code> indicates the name of the associated reference parameter (provides error checking; it should be redundant with par_id)</li>
<li><code>scale</code> indicates the scale used to specify the initial value, bounds, and prior (the values will be subsequently transformed as necessary to the scale used for the parameter in the model)</li>
<li><code>units</code> indicates any units associated with the initial value, bounds, and prior</li>
<li><code>phz</code> identifies the estimation phase in which the parameter should be “turned on” (never estimated if &lt; 0)</li>
<li><code>off_type</code> identifies the offset type (“offset” or “RW”, implying <a href="#eq-Eq1" class="quarto-xref">Equation&nbsp;1</a> or <a href="#eq-Eq2" class="quarto-xref">Equation&nbsp;2</a>)</li>
<li><code>RE</code> is a flag to regard the offsets as random effects</li>
<li><code>ival</code>, <code>lb</code>, <code>ub</code> specify the initial value and lower and upper bounds (the latter two are not included in the example)</li>
<li><code>pr_type</code> specifies the prior probability function associated with the estimated offsets</li>
<li><code>p1</code>,<code>p2</code> specify parameter values for the prior</li>
<li><code>label</code> specifies a specific label to use for the parameter</li>
</ul>
<p>The columns may be in any order, but (unlike a function definition table) all columns should be present.</p>
</section>
<section id="covariates" class="level5">
<h5 class="anchored" data-anchor-id="covariates">Covariates</h5>
<p>If covariates are defined for any reference parameter, then a table defining the associated parameters needs to follow the table(s) defining the reference parameters and any offset parameters. The annually-varying covariate effects (i.e., the <span class="math inline">\(\alpha_e \cdot v_{e,t} + \beta_e\)</span>) are defined for the reference parameters in tables similar to <a href="#tbl-Ex4" class="quarto-xref">Table&nbsp;4</a>, which follows on from <a href="#tbl-Ex2" class="quarto-xref">Table&nbsp;2</a>:</p>
<div id="tbl-Ex4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-Ex4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Example table of covariate-level parameters.
</figcaption>
<div aria-describedby="tbl-Ex4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 11%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">par_id</th>
<th style="text-align: center;">cov_id</th>
<th style="text-align: center;">covar</th>
<th style="text-align: center;">time_block</th>
<th style="text-align: center;">param</th>
<th style="text-align: center;">scale</th>
<th style="text-align: center;">units</th>
<th style="text-align: center;">phz</th>
<th style="text-align: center;">RE</th>
<th style="text-align: center;">ival</th>
<th style="text-align: center;">pr_type</th>
<th style="text-align: center;">p1</th>
<th style="text-align: center;">p2</th>
<th style="text-align: center;">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">e1</td>
<td style="text-align: center;">2001:2005</td>
<td style="text-align: center;">cov_alpha</td>
<td style="text-align: center;">ar</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">normal</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">cov_alpha_e1</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">e1</td>
<td style="text-align: center;">2001:2005</td>
<td style="text-align: center;">cov_beta</td>
<td style="text-align: center;">ar</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">normal</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">cov_beta_e1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">e2</td>
<td style="text-align: center;">2001:2005</td>
<td style="text-align: center;">cov_alpha</td>
<td style="text-align: center;">ar</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">normal</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">cov_alpha_e2</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">e2</td>
<td style="text-align: center;">2001:2005</td>
<td style="text-align: center;">cov_beta</td>
<td style="text-align: center;">ar</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">normal</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">cov_beta_e2</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>In <a href="#tbl-Ex4" class="quarto-xref">Table&nbsp;4</a>:</p>
<ul>
<li><code>par_id</code> identifies a row in the reference parameters definition table</li>
<li><code>cov_id</code> associates a unique positive integer with the covariate parameter, or a negative value indicating substitution with the parameter associated with the positive value</li>
<li><code>covar</code> indicates the name of the associated covariate</li>
<li><code>time_block</code> identifies the time block across which the covariates are applied</li>
<li><code>param</code> indicates the name of the covariate-level parameter</li>
<li><code>scale</code> indicates the scale used to specify the initial value, bounds, and prior (the values will be subsequently transformed as necessary to the scale used for the parameter in the model)</li>
<li><code>units</code> indicates any units associated with the initial value, bounds, and prior</li>
<li><code>phz</code> identifies the estimation phase in which the parameter should be “turned on” (never estimated if &lt; 0)</li>
<li><code>RE</code> is a flag (yes/no) to regard the offsets as random effects</li>
<li><code>ival</code>, <code>lb</code>, <code>ub</code> specify the initial value and lower and upper bounds (the latter two are not included in the example)</li>
<li><code>pr_type</code> specifies the prior probability function associated with the estimated offsets</li>
<li><code>p1</code>,<code>p2</code> specify parameter values for the prior</li>
<li><code>label</code> specifies a specific label to use for the parameter</li>
</ul>
</section>
</section>
</section>
</section>
<section id="sec-InitAbd" class="level2">
<h2 class="anchored" data-anchor-id="sec-InitAbd">Initial abundance</h2>
</section>
<section id="sec-Allom" class="level2">
<h2 class="anchored" data-anchor-id="sec-Allom">Allometry</h2>
</section>
<section id="sec-Rec" class="level2">
<h2 class="anchored" data-anchor-id="sec-Rec">Recruitment</h2>
</section>
<section id="sec-NatM" class="level2">
<h2 class="anchored" data-anchor-id="sec-NatM">Natural mortality</h2>
</section>
<section id="sec-Grw" class="level2">
<h2 class="anchored" data-anchor-id="sec-Grw">Growth</h2>
</section>
<section id="sec-Mat" class="level2">
<h2 class="anchored" data-anchor-id="sec-Mat">Maturity</h2>
</section>
<section id="sec-Sel" class="level2">
<h2 class="anchored" data-anchor-id="sec-Sel">Selectivity</h2>
<p>A number of 1-dimensional functions, listed in the subsections below, can be used to describe size-specific fishery or survey catchability, as well as fishery retention, by fleet and population categories. All have the the signature</p>
<p><span class="math display">\[ s = fcn(z,params,consts,debug=FALSE) \]</span></p>
<p>where <code>s</code> is an advector with the same number of elements as the vector <code>z</code>, representing the selectivity at the values of the vector <code>z</code>, <code>fcn</code> is the function, <code>params</code> is an advector representing the function parameters, and <code>consts</code> is a vector representing any required constants.</p>
<section id="sec-LogisticFunctions" class="level3">
<h3 class="anchored" data-anchor-id="sec-LogisticFunctions">Logistic functions</h3>
<p>Several logistic selectivity functions reflecting different parameterizations are available, including the <code>asclogistic</code>, <code>asclogistic1</code>, <code>asclogistic5095</code>, and <code>asclogistic50D95</code> functions. For each, <code>consts[1]</code> indicates the size at full selection if &gt; 0, that no rescaling will be done if = 0, or that the values should be normalized by the maximum if &lt; 0. Other elements of <code>consts</code> are ignored.</p>
<section id="ascending-logistic-alternative-1" class="level4">
<h4 class="anchored" data-anchor-id="ascending-logistic-alternative-1">Ascending logistic (alternative 1)</h4>
<p>The <code>asclogistic</code> function is parameterized by the size and width (1/slope) at 50% selected (<a href="#fig-AscLogistic1" class="quarto-xref">Figure&nbsp;1</a>).</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning in fun(libname, pkgname): couldn't connect to display
"/private/tmp/com.apple.launchd.DRbboYkDtw/org.xquartz:0"</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-AscLogistic1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-AscLogistic1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-AscLogistic1-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-AscLogistic1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Ascending logistic function <code>asclogistic</code> (green dotted line) selectivity function parameterized by the size and slope at 50% selected. <code>consts[1]</code> represents the size at full selection if &gt; 0, indicates no rescaling if = 0, and indicates that the values should be normalized by the maximum if &lt; 0. Here, <code>params</code>= (100,0.05) and consts = 125.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="ascending-logistic-alternative-2" class="level4">
<h4 class="anchored" data-anchor-id="ascending-logistic-alternative-2">Ascending logistic (alternative 2)</h4>
<p>The <code>asclogistic1</code> function is parameterized by the size and width (1/slope) at 50% selected (<a href="#fig-AscLogistic2" class="quarto-xref">Figure&nbsp;2</a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-AscLogistic2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-AscLogistic2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-AscLogistic2-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-AscLogistic2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Ascending logistic function <code>asclogistic1</code> (green dotted line) selectivity function parameterized by the size and width (1/slope) at 50% selected. <code>consts[1]</code> represents the size at full selection if &gt; 0, indicates no rescaling if = 0, and indicates that the values should be normalized by the maximum if &lt; 0. Here, <code>params</code>= (100,50) and consts = 125.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="ascending-logistic-alternative-3" class="level4">
<h4 class="anchored" data-anchor-id="ascending-logistic-alternative-3">Ascending logistic (alternative 3)</h4>
<p>The <code>asclogistic5095</code> function is parameterized by the sizes at 50% and 95% selected (<a href="#fig-AscLogistic3" class="quarto-xref">Figure&nbsp;3</a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-AscLogistic3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-AscLogistic3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-AscLogistic3-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-AscLogistic3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Ascending logistic function <code>asclogistic5095</code> (green dotted line) parameterized by sizes at 50% and 95% selected. <code>consts[1]</code> represents the size at full selection if &gt; 0, indicates no rescaling if = 0, and indicates that the values should be normalized by the maximum if &lt; 0. Here, <code>params</code>= (50,125) and consts = 0.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="ascending-logistic-alternative-4" class="level4">
<h4 class="anchored" data-anchor-id="ascending-logistic-alternative-4">Ascending logistic (alternative 4)</h4>
<p>The <code>asclogistic50D95</code> function is parameterized by the size at 50% and the difference between the 95% and 50% selected sizes (<a href="#fig-AscLogistic4" class="quarto-xref">Figure&nbsp;4</a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-AscLogistic4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-AscLogistic4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-AscLogistic4-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-AscLogistic4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Ascending logistic function <code>asclogistic50D95</code> (green dotted line) parameterized by the size at 50% and the difference between the 95% and 50% selected sizes. Here, <code>params</code>= (50,75) and consts = 0.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-AscNormalFunctions" class="level3">
<h3 class="anchored" data-anchor-id="sec-AscNormalFunctions">Ascending normal functions</h3>
<p>Several functions can be used to define a selectivity curve using the ascending portion of a normal (gaussian) curve and a sill. An ascending normal selectivity curve has an advantage over a logistic curve in an AD setting because it achieves its maximum (1) at a finite size, whereas logistic functions only approach their maximum values asymptotically. Functions defined include: <code>ascnormal1</code>, <code>ascnormal2</code>, <code>ascnormal2a</code>, <code>ascnormal2b</code>, <code>ascnormal3</code>.</p>
<section id="ascending-normal-alternative-1" class="level4">
<h4 class="anchored" data-anchor-id="ascending-normal-alternative-1">Ascending normal (alternative 1)</h4>
<p>The <code>ascnormal1</code> function is parameterized by the width of the ascending limb and the size at which it reaches 1 (<a href="#fig-AscNormal1" class="quarto-xref">Figure&nbsp;5</a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-AscNormal1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-AscNormal1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-AscNormal1-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-AscNormal1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Ascending normal function <code>ascnormal1</code> (green dotted line) selectivity function parameterized by the width of the ascending limb and the size at which it reaches 1. <code>consts</code> is ignored, but must a dummy value must be given. Here, <code>params</code>= (25,100) and consts = 50.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="ascending-normal-alternative-2" class="level4">
<h4 class="anchored" data-anchor-id="ascending-normal-alternative-2">Ascending normal (alternative 2)</h4>
<p>The <code>ascnormal2</code> function is parameterized by the value of selectivity at the reference size (<code>refZ</code>) and size at which ascending limb reaches 1 (<a href="#fig-AscNormal2" class="quarto-xref">Figure&nbsp;6</a>). <code>refZ</code> is specified by <code>consts[1]</code>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-AscNormal2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-AscNormal2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-AscNormal2-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-AscNormal2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Ascending normal function <code>ascnormal2</code> (green dotted line) selectivity function parameterized by the value of selectivity at the reference size (<code>refZ</code>) and size at which ascending limb reaches 1. <code>consts[1]</code> = <code>refZ</code>. Here, <code>params</code>= (0.5,100) and consts (<code>refZ</code>) = 50.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="ascending-normal-alternative-3" class="level4">
<h4 class="anchored" data-anchor-id="ascending-normal-alternative-3">Ascending normal (alternative 3)</h4>
<p>The <code>ascnormal2a</code> function is parameterized by the size at which selectivity reaches <code>refS</code> and the size at which the ascending limb reaches 1 (<a href="#fig-AscNormal3" class="quarto-xref">Figure&nbsp;7</a>). <code>consts[1]</code> = <code>refS</code>, the reference selectivity.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-AscNormal3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-AscNormal3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-AscNormal3-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-AscNormal3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Ascending normal function <code>ascnormal2a</code> (green dotted line) parameterized by the size at which selectivity reaches <code>refS</code> and the size at which the ascending limb reaches 1. <code>consts[1]</code> = <code>refS</code>, the reference selectivity. Here, <code>params</code>= (50,100) and <code>consts</code> (<code>refS</code>) = 0.5.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="ascending-normal-alternative-4" class="level4">
<h4 class="anchored" data-anchor-id="ascending-normal-alternative-4">Ascending normal (alternative 4)</h4>
<p>The <code>ascnormal2b</code> function is parameterized by the size at which ascending limb reaches 1 and the delta from the size at 1 to size at which selectivity = <code>refS</code> (<a href="#fig-AscNormal4" class="quarto-xref">Figure&nbsp;8</a>). <code>consts[1]</code> = <code>refS</code>, the reference selectivity.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-AscNormal4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-AscNormal4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-AscNormal4-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-AscNormal4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Ascending normal function <code>ascnormal2b</code> (green dotted line) parameterized by the size at 50% and the difference between the 95% and 50% selected sizes. Here, <code>params</code>= (150,75) and <code>consts</code> (<code>refS</code>) = 0.5.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-DoubleLogisticFunctions" class="level3">
<h3 class="anchored" data-anchor-id="sec-DoubleLogisticFunctions">Double logistic functions</h3>
<p>Several functions can be used to define a “double logistic” selectivity curve, which consists of the ascending part of a logistic function, possibly followed by a sill over intermediate sizes, followed by the descending part of a reversed logistic function. The two normal functions are determined by the location of their modes, as well as their associated widths. These include: <code>dbllogistic</code> and <code>dbllogistic5095</code>.</p>
</section>
<section id="double-logistic-function-alternative-1" class="level3">
<h3 class="anchored" data-anchor-id="double-logistic-function-alternative-1">Double logistic function (alternative 1)</h3>
<p>The double logistic function <code>dbllogistic</code> is parameterized by the ascending limb size at which selectivity = 0.5, the ascending limb slope at 50% selected, the descending limb size at which selectivity = 0, and the descending limb size at 50% selected. <code>consts[1]</code> represents the size at full selection if &gt; 0, indicates no rescaling if = 0, and indicates that the values should be normalized by the maximum if &lt; 0. An example is given in <a href="#fig-DblLogistic1" class="quarto-xref">Figure&nbsp;9</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-DblLogistic1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-DblLogistic1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-DblLogistic1-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-DblLogistic1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: The double logistic function <code>dbllogistic</code> (green dotted line) is parameterized by the ascending limb size at which selectivity = 0.5, the ascending limb slope at 50% selected, the descending limb size at which selectivity = 0, and the descending limb size at 50% selected. Here, <code>params</code>= (50,0.5,125,0.5) and <code>consts</code> (<code>refZ</code>) = 0.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="double-logistic-function-alternative-2" class="level3">
<h3 class="anchored" data-anchor-id="double-logistic-function-alternative-2">Double logistic function (alternative 2)</h3>
<p>The double logistic function <code>dbllogistic5095</code> is parameterized by the ascending limb size at 50% selected, the ascending limb size at 95% selected, the descending limb size at 95% selected, and the descending limb size at 50% selected. <code>consts[1]</code> represents the size at full selection if &gt; 0, indicates no rescaling if = 0, and indicates that the values should be normalized by the maximum if &lt; 0. An example is given in <a href="#fig-DblLogistic2" class="quarto-xref">Figure&nbsp;10</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-DblLogistic2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-DblLogistic2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-DblLogistic2-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-DblLogistic2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: The double logistic function <code>dbllogistic</code> (green dotted line) is parameterized by the ascending limb size at 50% selected, the ascending limb size at 95% selected, the descending limb size at 95% selected, and the descending limb size at 50% selected. Here, <code>params</code>= (50,100,125,150) and <code>consts</code> (<code>refZ</code>) = 0.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-DoubleNormalFunctions" class="level3">
<h3 class="anchored" data-anchor-id="sec-DoubleNormalFunctions">Double normal functions</h3>
<p>Several functions can be used to define a “double normal” selectivity curve, which consists of the left half (i.e., increasing up to the mode) of a normal (gaussian) function, possibly followed by a sill over intermediate sizes, followed by the right half of a normal function. These include: <code>dblnormal4</code>, <code>dblnormal4a</code>, and <code>dblnormal6</code>.</p>
<section id="sec-DblNrml4" class="level4">
<h4 class="anchored" data-anchor-id="sec-DblNrml4">4-parameter double normal (alternative 1)</h4>
<p>The 4-parameter double normal function <code>dblnormal4</code> is parameterized by the size at which ascending limb reaches 1, the width of ascending limb, the offset to size at which the descending limb departs from 1. The value of <code>consts</code> is ignored. An example is given in <a href="#fig-DblNrml6" class="quarto-xref">Figure&nbsp;13</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-DblNrml4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-DblNrml4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-DblNrml4-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-DblNrml4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: The 4-parameter double normal function <code>dblnormal6</code> (green dotted line) is parameterized by the size at which ascending limb reaches 1, the width of ascending limb, the offset to size at which the descending limb departs from 1, and the width of descending limb. Here, <code>params</code>= (100,50,40,35) and <code>consts</code> (= <code>refZ</code>) = 0.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-DblNrml4a" class="level4">
<h4 class="anchored" data-anchor-id="sec-DblNrml4a">4-parameter double normal (alternative 2)</h4>
<p>The 4-parameter double normal function <code>dblnormal4a</code> is parameterized by the size at which ascending limb reaches 1, the width of ascending limb, a scaled offset at which the descending limb departs from 1, and the width of descending limb. The value of <code>consts</code> is ignored. An example is given in <a href="#fig-DblNrml4a" class="quarto-xref">Figure&nbsp;12</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-DblNrml4a" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-DblNrml4a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-DblNrml4a-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-DblNrml4a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: The 4-parameter double normal function <code>dblnormal4a</code> (green dotted line) is parameterized by the size at which ascending limb reaches 1, the width of ascending limb, a scaled offset at which the descending limb departs from 1, and the width of descending limb. The value of <code>consts</code> is ignored. Here, <code>params</code>= (100,50,0.5,35) and <code>consts</code> (= <code>refZ</code>) = 0.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-DblNrml6" class="level4">
<h4 class="anchored" data-anchor-id="sec-DblNrml6">6-parameter double normal</h4>
<p>The 6-parameter double normal function <code>dblnormal6</code> is parameterized by the size at which ascending limb reaches 1, the width of ascending limb, size at which descending limb departs from 1, the width of descending limb, the floor of ascending limb, and the floor of descending limb. An example is given in <a href="#fig-DblNrml6" class="quarto-xref">Figure&nbsp;13</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-DblNrml6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-DblNrml6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-DblNrml6-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-DblNrml6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: The 6-parameter double normal function <code>dblnormal6</code> (green dotted line) is parameterized by the size at which ascending limb reaches 1, the width of ascending limb, size at which descending limb departs from 1, the width of descending limb, the floor of ascending limb, and the floor of descending limb. Here, <code>params</code>= (100,50,125,35,0.1,0.1) and <code>consts</code> (= <code>refZ</code>) = 0.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-Splines" class="level3">
<h3 class="anchored" data-anchor-id="sec-Splines">Splines</h3>
<p>Two types of spline functions can be used to model selectivity: natural splines and clamped splines. Natural splines are cubic splines whose second derivatives are zero at the boundary knot locations, with the property that extrapolated values have a constant slope. Clamped splines are cubic splines whose first and second derivatives are zero at one or both boundary knot locations, with the property that extrapolated values are “clamped” to (the same as that at) the nearest boundary knot. Functions that represent splines clamped at both ends or at either end are available.</p>
<section id="sec-NaturalSplines" class="level4">
<h4 class="anchored" data-anchor-id="sec-NaturalSplines">Natural splines</h4>
<p>The <code>selSpline</code> function, with signature <code>(z,params,knots,debug=FALSE)</code>, is used to represent size-specific selectivity using a natural spline. <code>params</code> is a k-length advector representing the logit-scale values of the estimated selectivity curve at the <code>k</code> knots. The knot locations are given by the first <code>k</code> values of the <code>consts</code> vector. An example is given in Figure <a href="#fig-SelSpline" class="quarto-xref">14</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-SelSpline" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-SelSpline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-SelSpline-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-SelSpline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: The spline function <code>selSpline</code> (green dotted line) fit to a double normal selectivity function with additive noise (observed=red; underlying ‘true’ R function=blue). The solid green line represents the spline function fit to the ‘true’ values.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-ClampedSpline" class="level4">
<h4 class="anchored" data-anchor-id="sec-ClampedSpline">Clamped splines</h4>
<p>The <code>selSplineClmpd</code> function, with signature <code>(z,params,knots,debug=FALSE)</code>, is used to represent size-specific selectivity with a spline that is clamped (to different values) at both ends. <code>params</code> is a k-length advector representing the logit-scale values of the estimated selectivity curve at the <code>k</code> knots. The knot locations are given by the first <code>k</code> values of the <code>consts</code> vector. An example is given in Figure <a href="#fig-SelSplineClmpd" class="quarto-xref">15</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-SelSplineClmpd" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-SelSplineClmpd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-SelSplineClmpd-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-SelSplineClmpd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: The clamped spline function <code>selSplineClmpd</code> (green dotted line) fit to a double normal selectivity function with additive noise (observed=red; underlying ‘true’ R function=blue). The solid green line represents the spline function fit to the ‘true’ values.
</figcaption>
</figure>
</div>
</div>
</div>
<section id="left-clamped-splines" class="level5">
<h5 class="anchored" data-anchor-id="left-clamped-splines">Left-clamped splines</h5>
<p>The <code>selSplineClmpdLeft</code> function, with signature <code>(z,params,knots,debug=FALSE)</code>, is used to represent size-specific selectivity with a spline that is clamped at small sizes (i.e., the left end). <code>params</code> is a k-length advector representing the logit-scale values of the estimated selectivity curve at the <code>k</code> knots. The knot locations are given by the first <code>k</code> values of the <code>consts</code> vector. An example is given in Figure <a href="#fig-SelSplineClmpdLeft" class="quarto-xref">16</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-SelSplineClmpdLeft" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-SelSplineClmpdLeft-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-SelSplineClmpdLeft-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-SelSplineClmpdLeft-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: Left-clamped spline function <code>selSplineClmpdLeft</code> (green dotted line) fit to a double normal selectivity function with additive noise (observed=red; underlying ‘true’ R function=blue). The solid green line represents the spline function fit to the ‘true’ values.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="right-clamped-splines" class="level5">
<h5 class="anchored" data-anchor-id="right-clamped-splines">Right-clamped splines</h5>
<p>The <code>selSplineClmpdRight</code> function, with signature <code>(z,params,knots,debug=FALSE)</code>, is used to represent size-specific selectivity with a spline that is clamped at large sizes (i.e., the right end). <code>params</code> is a k-length advector representing the logit-scale values of the estimated selectivity curve at the <code>k</code> knots. The knot locations are given by the first <code>k</code> values of the <code>consts</code> vector. An example is given in Figure <a href="#fig-SelSplineClmpdRight" class="quarto-xref">17</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-SelSplineClmpdRight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-SelSplineClmpdRight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-SelSplineClmpdRight-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-SelSplineClmpdRight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: The right-clamped spline function <code>selSplineClmpdRight</code> (green dotted line) fit to a double normal selectivity function with additive noise (observed=red; underlying ‘true’ R function=blue). The solid green line represents the spline function fit to the ‘true’ values.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="sec-OtherSelFcns" class="level3">
<h3 class="anchored" data-anchor-id="sec-OtherSelFcns">Other selectivity functions</h3>
<p>Miscellaneous selectivity functions described in this section include: a constant function and a “stacked” logistic function.</p>
<section id="sec-ConstSel" class="level4">
<h4 class="anchored" data-anchor-id="sec-ConstSel">Constant selectivity</h4>
<p>The <code>const_sel</code> function (<a href="#fig-SelConst" class="quarto-xref">Figure&nbsp;18</a>) is used to represent selectivity that is not size-specific (i.e.., the same at all sizes). It has a signature <code>(z,params,consts)</code> to match other functions, although <code>consts</code> is ignored (if <code>consts[1]</code> were used as a reference size, the function would be non-differentiable).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-SelConst" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-SelConst-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-SelConst-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-SelConst-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18: Constant selectivity function (green dotted line) fit to a constant with additive noise (observed=red; underlying ‘true’ R function=blue). The solid green line represents the function fit to the ‘true’ values. Here, <code>params</code> = 1.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="stacked-logistic" class="level4">
<h4 class="anchored" data-anchor-id="stacked-logistic">Stacked logistic</h4>
<p>The <code>stackedLogistic1</code> function (<a href="#fig-StackedLogistic" class="quarto-xref">Figure&nbsp;19</a>) provides a 5-parameter selectivity function that is formed using two ascending logistic curves, with one stacked atop the other. The function is parameterized by a weighting factor on the first curve (<code>omega</code>), the size at the inflection point of the first logistic curve (<code>mnZ1</code>), the width of the first logistic curve (<code>sdZ1</code>), the size at the inflection point of the second logistic curve (<code>mnZ2</code>), and the width of the second logistic curve (<code>sdZ2</code>). <code>params</code> is the vector (<code>omega</code>,<code>mnZ1</code>,<code>sdZ1</code>,<code>mnZ2</code>,<code>sdZ2</code>). The value of <code>consts</code> is ignored.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-StackedLogistic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-StackedLogistic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_FunctionsAndParametersSpecification_files/figure-html/fig-StackedLogistic-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-StackedLogistic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19: The stacked logistic selectivity function (green dotted line) fit to a constant with additive noise (observed=red; underlying ‘true’ R function=blue). The solid green line represents the function fit to the ‘true’ values. Here, <code>params</code> = (0.2,75,10,145,10).
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="sec-FM" class="level2">
<h2 class="anchored" data-anchor-id="sec-FM">Fishing mortality</h2>
</section>
<section id="sec-Srv" class="level2">
<h2 class="anchored" data-anchor-id="sec-Srv">Survey catchability</h2>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/wstockhausen\.github\.io\/rtmbGMACS\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../website/03_ModelDimensions.html" class="pagination-link" aria-label="Model Dimensions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Model Dimensions</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../website/05_ADMB-InputFiles.html" class="pagination-link" aria-label="Using ADMB Input files">
        <span class="nav-page-text">Using ADMB Input files</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2025-01-21</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/wStockhausen/rtmbGMACS/edit/main/website/04_FunctionsAndParametersSpecification.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/wStockhausen/rtmbGMACS/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>